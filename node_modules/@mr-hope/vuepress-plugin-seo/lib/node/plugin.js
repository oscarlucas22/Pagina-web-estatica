"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.seoPlugin = void 0;
const chalk_1 = require("chalk");
const seo_1 = require("./seo");
const stripTags_1 = require("./stripTags");
const utils_1 = require("./utils");
const seoPlugin = (options, context) => {
    const plugin = { name: "vuepress-plugin-seo" };
    if (!options.hostname) {
        console.log((0, chalk_1.blue)("SEO:"), chalk_1.black.bgRed("error"), `Option ${(0, chalk_1.cyan)("hostname")} is required!`);
        return plugin;
    }
    return {
        ...plugin,
        extendPageData: (page) => {
            // generate summary
            if (!page.frontmatter.description)
                page.frontmatter.summary =
                    (0, stripTags_1.striptags)(page.excerpt) ||
                        (0, utils_1.md2text)(page._strippedContent).slice(0, 180) ||
                        "";
            // In VuePress1, permalinks are built after enhancers.
            const pageClone = Object.assign(Object.create(Object.getPrototypeOf(page)), page);
            pageClone.buildPermalink();
            (0, seo_1.appendSEO)(pageClone, options, context);
        },
        generated: async () => (0, seo_1.generateRobotsTxt)(context),
        plugins: [["@mr-hope/git", true]],
    };
};
exports.seoPlugin = seoPlugin;
//# sourceMappingURL=plugin.js.map