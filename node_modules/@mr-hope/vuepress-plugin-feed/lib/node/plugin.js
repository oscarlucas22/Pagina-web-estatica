"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.feedPlugin = void 0;
const tslib_1 = require("tslib");
const chalk_1 = tslib_1.__importDefault(require("chalk"));
const compact_1 = require("./compact");
const injectHead_1 = require("./injectHead");
const generator_1 = require("./generator");
const options_1 = require("./options");
const utils_1 = require("./utils");
const feedPlugin = (options, context) => {
    const plugin = {
        name: "@mr-hope/vuepress-plugin-feed",
    };
    (0, compact_1.covertOptions)(options);
    if (!(0, options_1.ensureHostName)(options)) {
        (0, utils_1.error)(`Option ${chalk_1.default.magenta("hostname")} is required!`);
        return plugin;
    }
    if (!(0, options_1.checkOutput)(options)) {
        (0, utils_1.info)("No requested output, the plugin wonâ€™t start!");
        return plugin;
    }
    const feedOptions = (0, options_1.getFeedOptions)(context, options);
    return {
        ...plugin,
        ready: () => (0, injectHead_1.injectLinkstoHead)(context, feedOptions),
        generated: async () => {
            await new generator_1.FeedGenerator(context, feedOptions).generateFeed();
        },
    };
};
exports.feedPlugin = feedPlugin;
//# sourceMappingURL=plugin.js.map